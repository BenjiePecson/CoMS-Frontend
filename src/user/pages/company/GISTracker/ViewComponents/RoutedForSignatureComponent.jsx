import { useEffect, useState } from "react";
import { useDispatch, useSelector } from "react-redux";
import {
  fetchRecord,
  gdrivefoldersState,
} from "../../../../store/GIS/GISRecordSlice";
import { useParams } from "react-router-dom";
import FrameWrapper from "../../DashboardComponents/FrameWrapper";
import Swal from "sweetalert2";
import axios from "axios";
import { showToast } from "../../../../../assets/global";

const RoutedForSignatureComponent = () => {
  const { companyId, recordId } = useParams();

  const selectedRecord = useSelector((state) => state.records.selectedRecord);

  const currentUser = useSelector((state) => state.user.user);

  const [errors, setErrors] = useState([]);

  const [gdrivefolder, setgdrivefolder] = useState("");

  const [showEdit, setShowEdit] = useState(false);

  const toggleUpdate = (setStatus, dialogText, btnText) => {
    Swal.fire({
      title: "Are you sure?",
      text: dialogText,
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#273069",
      confirmButtonText: btnText,
      cancelButtonColor: "#CDCDCD",
    }).then(async (result) => {
      if (result.isConfirmed) {
        let status = "error";
        let message = "Failed to update the record.";
        try {
          let response = await axios.patch(
            `/record/record/${selectedRecord.recordId}`,
            { status: setStatus }
          );

          if (response.status === 200) {
            status = "success";
            message = "Record was updated successfully.";
            // navigate(`/company/${companyId}/secretary-certificate`);
            dispatch(fetchRecord(recordId));
          }
        } catch (error) {
          console.log(error);
        } finally {
          showToast(status, message);
        }
      }
    });
  };

  const routedForSignatureSVG = (
    <svg
      className="w-1/2"
      viewBox="0 0 404 388"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M163 370.436V372.47H157.762V375.692H161.776V377.69H157.762V383H155.242V370.436H163ZM169.215 383.162C168.255 383.162 167.391 382.952 166.623 382.532C165.855 382.1 165.249 381.494 164.805 380.714C164.373 379.934 164.157 379.034 164.157 378.014C164.157 376.994 164.379 376.094 164.823 375.314C165.279 374.534 165.897 373.934 166.677 373.514C167.457 373.082 168.327 372.866 169.287 372.866C170.247 372.866 171.117 373.082 171.897 373.514C172.677 373.934 173.289 374.534 173.733 375.314C174.189 376.094 174.417 376.994 174.417 378.014C174.417 379.034 174.183 379.934 173.715 380.714C173.259 381.494 172.635 382.1 171.843 382.532C171.063 382.952 170.187 383.162 169.215 383.162ZM169.215 380.966C169.671 380.966 170.097 380.858 170.493 380.642C170.901 380.414 171.225 380.078 171.465 379.634C171.705 379.19 171.825 378.65 171.825 378.014C171.825 377.066 171.573 376.34 171.069 375.836C170.577 375.32 169.971 375.062 169.251 375.062C168.531 375.062 167.925 375.32 167.433 375.836C166.953 376.34 166.713 377.066 166.713 378.014C166.713 378.962 166.947 379.694 167.415 380.21C167.895 380.714 168.495 380.966 169.215 380.966ZM178.785 374.576C179.109 374.048 179.529 373.634 180.045 373.334C180.573 373.034 181.173 372.884 181.845 372.884V375.53H181.179C180.387 375.53 179.787 375.716 179.379 376.088C178.983 376.46 178.785 377.108 178.785 378.032V383H176.265V373.028H178.785V374.576ZM192.17 383.126C191.294 383.126 190.502 382.976 189.794 382.676C189.098 382.376 188.546 381.944 188.138 381.38C187.73 380.816 187.52 380.15 187.508 379.382H190.208C190.244 379.898 190.424 380.306 190.748 380.606C191.084 380.906 191.54 381.056 192.116 381.056C192.704 381.056 193.166 380.918 193.502 380.642C193.838 380.354 194.006 379.982 194.006 379.526C194.006 379.154 193.892 378.848 193.664 378.608C193.436 378.368 193.148 378.182 192.8 378.05C192.464 377.906 191.996 377.75 191.396 377.582C190.58 377.342 189.914 377.108 189.398 376.88C188.894 376.64 188.456 376.286 188.084 375.818C187.724 375.338 187.544 374.702 187.544 373.91C187.544 373.166 187.73 372.518 188.102 371.966C188.474 371.414 188.996 370.994 189.668 370.706C190.34 370.406 191.108 370.256 191.972 370.256C193.268 370.256 194.318 370.574 195.122 371.21C195.938 371.834 196.388 372.71 196.472 373.838H193.7C193.676 373.406 193.49 373.052 193.142 372.776C192.806 372.488 192.356 372.344 191.792 372.344C191.3 372.344 190.904 372.47 190.604 372.722C190.316 372.974 190.172 373.34 190.172 373.82C190.172 374.156 190.28 374.438 190.496 374.666C190.724 374.882 191 375.062 191.324 375.206C191.66 375.338 192.128 375.494 192.728 375.674C193.544 375.914 194.21 376.154 194.726 376.394C195.242 376.634 195.686 376.994 196.058 377.474C196.43 377.954 196.616 378.584 196.616 379.364C196.616 380.036 196.442 380.66 196.094 381.236C195.746 381.812 195.236 382.274 194.564 382.622C193.892 382.958 193.094 383.126 192.17 383.126ZM200.079 371.84C199.635 371.84 199.263 371.702 198.963 371.426C198.675 371.138 198.531 370.784 198.531 370.364C198.531 369.944 198.675 369.596 198.963 369.32C199.263 369.032 199.635 368.888 200.079 368.888C200.523 368.888 200.889 369.032 201.177 369.32C201.477 369.596 201.627 369.944 201.627 370.364C201.627 370.784 201.477 371.138 201.177 371.426C200.889 371.702 200.523 371.84 200.079 371.84ZM201.321 373.028V383H198.801V373.028H201.321ZM207.716 372.866C208.46 372.866 209.114 373.016 209.678 373.316C210.242 373.604 210.686 373.982 211.01 374.45V373.028H213.548V383.072C213.548 383.996 213.362 384.818 212.99 385.538C212.618 386.27 212.06 386.846 211.316 387.266C210.572 387.698 209.672 387.914 208.616 387.914C207.2 387.914 206.036 387.584 205.124 386.924C204.224 386.264 203.714 385.364 203.594 384.224H206.096C206.228 384.68 206.51 385.04 206.942 385.304C207.386 385.58 207.92 385.718 208.544 385.718C209.276 385.718 209.87 385.496 210.326 385.052C210.782 384.62 211.01 383.96 211.01 383.072V381.524C210.686 381.992 210.236 382.382 209.66 382.694C209.096 383.006 208.448 383.162 207.716 383.162C206.876 383.162 206.108 382.946 205.412 382.514C204.716 382.082 204.164 381.476 203.756 380.696C203.36 379.904 203.162 378.998 203.162 377.978C203.162 376.97 203.36 376.076 203.756 375.296C204.164 374.516 204.71 373.916 205.394 373.496C206.09 373.076 206.864 372.866 207.716 372.866ZM211.01 378.014C211.01 377.402 210.89 376.88 210.65 376.448C210.41 376.004 210.086 375.668 209.678 375.44C209.27 375.2 208.832 375.08 208.364 375.08C207.896 375.08 207.464 375.194 207.068 375.422C206.672 375.65 206.348 375.986 206.096 376.43C205.856 376.862 205.736 377.378 205.736 377.978C205.736 378.578 205.856 379.106 206.096 379.562C206.348 380.006 206.672 380.348 207.068 380.588C207.476 380.828 207.908 380.948 208.364 380.948C208.832 380.948 209.27 380.834 209.678 380.606C210.086 380.366 210.41 380.03 210.65 379.598C210.89 379.154 211.01 378.626 211.01 378.014ZM221.536 372.884C222.724 372.884 223.684 373.262 224.416 374.018C225.148 374.762 225.514 375.806 225.514 377.15V383H222.994V377.492C222.994 376.7 222.796 376.094 222.4 375.674C222.004 375.242 221.464 375.026 220.78 375.026C220.084 375.026 219.532 375.242 219.124 375.674C218.728 376.094 218.53 376.7 218.53 377.492V383H216.01V373.028H218.53V374.27C218.866 373.838 219.292 373.502 219.808 373.262C220.336 373.01 220.912 372.884 221.536 372.884ZM227.262 377.978C227.262 376.97 227.46 376.076 227.856 375.296C228.264 374.516 228.81 373.916 229.494 373.496C230.19 373.076 230.964 372.866 231.816 372.866C232.56 372.866 233.208 373.016 233.76 373.316C234.324 373.616 234.774 373.994 235.11 374.45V373.028H237.648V383H235.11V381.542C234.786 382.01 234.336 382.4 233.76 382.712C233.196 383.012 232.542 383.162 231.798 383.162C230.958 383.162 230.19 382.946 229.494 382.514C228.81 382.082 228.264 381.476 227.856 380.696C227.46 379.904 227.262 378.998 227.262 377.978ZM235.11 378.014C235.11 377.402 234.99 376.88 234.75 376.448C234.51 376.004 234.186 375.668 233.778 375.44C233.37 375.2 232.932 375.08 232.464 375.08C231.996 375.08 231.564 375.194 231.168 375.422C230.772 375.65 230.448 375.986 230.196 376.43C229.956 376.862 229.836 377.378 229.836 377.978C229.836 378.578 229.956 379.106 230.196 379.562C230.448 380.006 230.772 380.348 231.168 380.588C231.576 380.828 232.008 380.948 232.464 380.948C232.932 380.948 233.37 380.834 233.778 380.606C234.186 380.366 234.51 380.03 234.75 379.598C234.99 379.154 235.11 378.626 235.11 378.014ZM243.043 375.098V379.922C243.043 380.258 243.121 380.504 243.277 380.66C243.445 380.804 243.721 380.876 244.105 380.876H245.275V383H243.691C241.567 383 240.505 381.968 240.505 379.904V375.098H239.317V373.028H240.505V370.562H243.043V373.028H245.275V375.098H243.043ZM256.502 373.028V383H253.964V381.74C253.64 382.172 253.214 382.514 252.686 382.766C252.17 383.006 251.606 383.126 250.994 383.126C250.214 383.126 249.524 382.964 248.924 382.64C248.324 382.304 247.85 381.818 247.502 381.182C247.166 380.534 246.998 379.766 246.998 378.878V373.028H249.518V378.518C249.518 379.31 249.716 379.922 250.112 380.354C250.508 380.774 251.048 380.984 251.732 380.984C252.428 380.984 252.974 380.774 253.37 380.354C253.766 379.922 253.964 379.31 253.964 378.518V373.028H256.502ZM261.508 374.576C261.832 374.048 262.252 373.634 262.768 373.334C263.296 373.034 263.896 372.884 264.568 372.884V375.53H263.902C263.11 375.53 262.51 375.716 262.102 376.088C261.706 376.46 261.508 377.108 261.508 378.032V383H258.988V373.028H261.508V374.576ZM275.535 377.798C275.535 378.158 275.511 378.482 275.463 378.77H268.173C268.233 379.49 268.485 380.054 268.929 380.462C269.373 380.87 269.919 381.074 270.567 381.074C271.503 381.074 272.169 380.672 272.565 379.868H275.283C274.995 380.828 274.443 381.62 273.627 382.244C272.811 382.856 271.809 383.162 270.621 383.162C269.661 383.162 268.797 382.952 268.029 382.532C267.273 382.1 266.679 381.494 266.247 380.714C265.827 379.934 265.617 379.034 265.617 378.014C265.617 376.982 265.827 376.076 266.247 375.296C266.667 374.516 267.255 373.916 268.011 373.496C268.767 373.076 269.637 372.866 270.621 372.866C271.569 372.866 272.415 373.07 273.159 373.478C273.915 373.886 274.497 374.468 274.905 375.224C275.325 375.968 275.535 376.826 275.535 377.798ZM272.925 377.078C272.913 376.43 272.679 375.914 272.223 375.53C271.767 375.134 271.209 374.936 270.549 374.936C269.925 374.936 269.397 375.128 268.965 375.512C268.545 375.884 268.287 376.406 268.191 377.078H272.925Z"
        fill="black"
      />
      <g clipPath="url(#clip0_0_1)">
        <path
          d="M206.901 0.79149L193.756 4.18529L31.8012 45.9977L18.6558 49.3915C12.2751 51.0464 6.81076 55.1677 3.4615 60.8512C0.112246 66.5346 -0.848381 73.316 0.79037 79.7076L57.7919 300.998C59.445 307.386 63.5616 312.857 69.2386 316.21C74.9155 319.563 81.6892 320.525 88.0736 318.884L88.1075 318.875L276.285 270.293L276.319 270.284C282.7 268.629 288.164 264.508 291.513 258.824C294.863 253.141 295.823 246.36 294.184 239.968L237.183 18.6773C235.53 12.2894 231.413 6.81881 225.736 3.46572C220.059 0.112627 213.286 -0.849115 206.901 0.79149Z"
          fill="#F2F2F2"
        />
        <path
          d="M208.689 7.72952L193.119 11.7493L36.0127 52.3099L20.4431 56.3295C15.8993 57.5081 12.0079 60.4429 9.62284 64.4902C7.23774 68.5375 6.55365 73.3667 7.72064 77.9183L64.7222 299.209C65.8994 303.758 68.831 307.654 72.8736 310.042C76.9163 312.429 81.74 313.114 86.2865 311.946L86.3204 311.937L274.498 263.355L274.532 263.346C279.076 262.167 282.967 259.232 285.352 255.185C287.737 251.138 288.421 246.309 287.254 241.757L230.253 20.4665C229.076 15.9175 226.144 12.0218 222.102 9.63399C218.059 7.24617 213.235 6.56127 208.689 7.72952Z"
          fill="white"
        />
        <path
          d="M196.932 79.3892L101.738 103.966C100.675 104.24 99.546 104.081 98.6003 103.522C97.6546 102.964 96.9693 102.052 96.6951 100.987C96.4209 99.923 96.5804 98.7931 97.1383 97.8464C97.6962 96.8996 98.607 96.2135 99.6702 95.939L194.865 71.3623C195.927 71.0889 197.055 71.2492 198 71.8079C198.945 72.3665 199.63 73.2779 199.904 74.3417C200.178 75.4055 200.019 76.5347 199.462 77.4812C198.904 78.4277 197.995 79.114 196.932 79.3892Z"
          fill="#F2F2F2"
        />
        <path
          d="M216.958 88.6653L105.227 117.511C104.163 117.786 103.035 117.626 102.089 117.068C101.143 116.509 100.458 115.597 100.184 114.533C99.9097 113.468 100.069 112.339 100.627 111.392C101.185 110.445 102.096 109.759 103.159 109.484L214.89 80.6384C215.953 80.3639 217.082 80.5235 218.028 81.0821C218.973 81.6406 219.659 82.5524 219.933 83.6169C220.207 84.6813 220.048 85.8112 219.49 86.7579C218.932 87.7047 218.021 88.3908 216.958 88.6653Z"
          fill="#F2F2F2"
        />
        <path
          d="M212.569 140.093L117.374 164.669C116.848 164.805 116.3 164.836 115.761 164.76C115.223 164.684 114.705 164.502 114.237 164.226C113.768 163.949 113.359 163.583 113.032 163.148C112.705 162.713 112.467 162.218 112.331 161.691C112.196 161.164 112.165 160.615 112.241 160.076C112.317 159.537 112.498 159.019 112.775 158.55C113.051 158.081 113.417 157.671 113.851 157.344C114.285 157.017 114.78 156.778 115.306 156.643L210.501 132.066C211.027 131.93 211.575 131.899 212.114 131.975C212.652 132.051 213.17 132.233 213.638 132.51C214.107 132.786 214.516 133.152 214.843 133.587C215.17 134.022 215.408 134.517 215.544 135.044C215.679 135.571 215.71 136.12 215.634 136.659C215.558 137.198 215.377 137.717 215.1 138.185C214.824 138.654 214.458 139.064 214.024 139.391C213.59 139.718 213.095 139.957 212.569 140.093Z"
          fill="#F2F2F2"
        />
        <path
          d="M232.594 149.369L120.863 178.215C120.337 178.351 119.789 178.381 119.25 178.305C118.712 178.229 118.194 178.048 117.726 177.771C117.258 177.494 116.848 177.128 116.521 176.693C116.194 176.258 115.956 175.763 115.821 175.236C115.685 174.709 115.654 174.161 115.73 173.622C115.806 173.083 115.988 172.564 116.264 172.095C116.54 171.626 116.906 171.217 117.34 170.889C117.775 170.562 118.269 170.324 118.796 170.188L230.527 141.342C231.59 141.067 232.719 141.227 233.664 141.785C234.61 142.344 235.295 143.256 235.57 144.32C235.844 145.385 235.684 146.515 235.126 147.461C234.568 148.408 233.658 149.094 232.594 149.369Z"
          fill="#F2F2F2"
        />
        <path
          d="M228.205 200.796L133.01 225.373C131.948 225.646 130.82 225.486 129.874 224.928C128.929 224.369 128.245 223.458 127.971 222.394C127.696 221.33 127.856 220.2 128.413 219.254C128.97 218.307 129.88 217.621 130.943 217.346L226.137 192.769C227.201 192.495 228.329 192.654 229.275 193.213C230.22 193.771 230.906 194.683 231.18 195.748C231.454 196.812 231.295 197.942 230.737 198.889C230.179 199.836 229.268 200.522 228.205 200.796Z"
          fill="#F2F2F2"
        />
        <path
          d="M248.231 210.072L136.5 238.918C135.973 239.055 135.425 239.086 134.886 239.01C134.347 238.934 133.829 238.753 133.36 238.476C132.892 238.2 132.482 237.834 132.155 237.399C131.828 236.964 131.589 236.468 131.453 235.941C131.318 235.413 131.287 234.864 131.363 234.325C131.439 233.786 131.621 233.267 131.898 232.798C132.174 232.329 132.54 231.919 132.975 231.592C133.41 231.265 133.905 231.027 134.432 230.891L246.163 202.045C247.226 201.771 248.355 201.93 249.301 202.489C250.246 203.048 250.932 203.959 251.206 205.024C251.48 206.088 251.321 207.218 250.763 208.165C250.205 209.112 249.294 209.798 248.231 210.072Z"
          fill="#F2F2F2"
        />
        <path
          d="M85.4864 129.166L51.798 137.863C51.2882 137.994 50.7473 137.917 50.294 137.65C49.8407 137.382 49.512 136.945 49.38 136.435L41.6469 106.413C41.516 105.903 41.5927 105.361 41.8602 104.908C42.1276 104.454 42.5639 104.125 43.0734 103.993L76.7619 95.2952C77.2716 95.1641 77.8125 95.2409 78.2658 95.5087C78.7191 95.7764 79.0478 96.2132 79.1798 96.7233L86.913 126.745C87.0438 127.255 86.9672 127.797 86.6997 128.251C86.4323 128.704 85.9959 129.033 85.4864 129.166Z"
          fill="#E6E6E6"
        />
        <path
          d="M101.123 189.869L67.4347 198.567C66.9249 198.698 66.3841 198.621 65.9307 198.353C65.4774 198.085 65.1487 197.649 65.0167 197.138L57.2836 167.117C57.1527 166.607 57.2295 166.065 57.4969 165.611C57.7643 165.157 58.2007 164.828 58.7102 164.696L92.3986 155.999C92.9084 155.868 93.4492 155.945 93.9025 156.212C94.3558 156.48 94.6846 156.917 94.8165 157.427L102.55 187.448C102.681 187.959 102.604 188.5 102.336 188.954C102.069 189.408 101.633 189.737 101.123 189.869Z"
          fill="#E6E6E6"
        />
        <path
          d="M116.759 250.573L83.071 259.27C82.5612 259.401 82.0203 259.324 81.567 259.056C81.1137 258.789 80.785 258.352 80.653 257.842L72.9198 227.82C72.789 227.31 72.8657 226.768 73.1331 226.315C73.4006 225.861 73.8369 225.532 74.3464 225.4L108.035 216.702C108.545 216.571 109.085 216.648 109.539 216.916C109.992 217.183 110.321 217.62 110.453 218.13L118.186 248.152C118.317 248.662 118.24 249.204 117.973 249.658C117.705 250.111 117.269 250.44 116.759 250.573Z"
          fill="#E6E6E6"
        />
        <path
          d="M338.193 56.8857H143.789C137.198 56.8932 130.879 59.5178 126.218 64.1839C121.557 68.85 118.936 75.1764 118.928 81.7752V310.306C118.936 316.904 121.557 323.231 126.218 327.897C130.879 332.563 137.198 335.188 143.789 335.195H338.193C344.785 335.188 351.104 332.563 355.765 327.897C360.425 323.231 363.047 316.904 363.055 310.306V81.7752C363.047 75.1764 360.425 68.85 355.765 64.1839C351.104 59.5178 344.785 56.8932 338.193 56.8857Z"
          fill="#E6E6E6"
        />
        <path
          d="M338.194 64.051H143.789C139.095 64.0563 134.595 65.9254 131.276 69.2482C127.957 72.571 126.09 77.0762 126.085 81.7754V310.306C126.09 315.005 127.957 319.51 131.276 322.833C134.595 326.156 139.095 328.025 143.789 328.03H338.194C342.887 328.025 347.387 326.156 350.706 322.833C354.025 319.51 355.892 315.005 355.897 310.306V81.7754C355.892 77.0762 354.025 72.5711 350.706 69.2483C347.387 65.9254 342.887 64.0563 338.194 64.051Z"
          fill="white"
        />
        <path
          d="M358.617 363C383.681 363 404 342.658 404 317.565C404 292.472 383.681 272.131 358.617 272.131C333.553 272.131 313.234 292.472 313.234 317.565C313.234 342.658 333.553 363 358.617 363Z"
          fill="#273069"
        />
        <path
          d="M308.935 189.628H210.627C210.083 189.629 209.544 189.522 209.041 189.314C208.538 189.106 208.081 188.801 207.696 188.416C207.311 188.031 207.006 187.574 206.798 187.07C206.589 186.567 206.482 186.028 206.482 185.483C206.482 184.938 206.589 184.399 206.798 183.896C207.006 183.393 207.311 182.936 207.696 182.551C208.081 182.166 208.538 181.861 209.041 181.653C209.544 181.445 210.083 181.338 210.627 181.338H308.935C310.033 181.34 311.085 181.777 311.86 182.554C312.635 183.331 313.071 184.385 313.071 185.483C313.071 186.582 312.635 187.635 311.86 188.412C311.085 189.189 310.033 189.627 308.935 189.628Z"
          fill="#E6E6E6"
        />
        <path
          d="M326.013 203.616H210.627C210.083 203.617 209.544 203.51 209.041 203.302C208.538 203.094 208.081 202.789 207.696 202.404C207.311 202.019 207.006 201.562 206.798 201.059C206.589 200.556 206.482 200.016 206.482 199.472C206.482 198.927 206.589 198.388 206.798 197.884C207.006 197.381 207.311 196.924 207.696 196.539C208.081 196.154 208.538 195.849 209.041 195.641C209.544 195.433 210.083 195.326 210.627 195.327H326.013C327.111 195.327 328.164 195.764 328.941 196.541C329.717 197.318 330.153 198.372 330.153 199.472C330.153 200.571 329.717 201.625 328.941 202.402C328.164 203.18 327.111 203.616 326.013 203.616Z"
          fill="#E6E6E6"
        />
        <path
          d="M308.935 252.317H210.627C210.083 252.318 209.544 252.211 209.041 252.003C208.538 251.795 208.081 251.49 207.696 251.105C207.311 250.72 207.006 250.263 206.798 249.76C206.589 249.257 206.482 248.717 206.482 248.173C206.482 247.628 206.589 247.089 206.798 246.585C207.006 246.082 207.311 245.625 207.696 245.24C208.081 244.855 208.538 244.55 209.041 244.342C209.544 244.134 210.083 244.027 210.627 244.028H308.935C310.033 244.028 311.087 244.465 311.863 245.242C312.639 246.019 313.075 247.073 313.075 248.173C313.075 249.272 312.639 250.326 311.863 251.103C311.087 251.881 310.033 252.317 308.935 252.317Z"
          fill="#E6E6E6"
        />
        <path
          d="M326.013 266.306H210.627C210.083 266.307 209.544 266.2 209.041 265.992C208.538 265.784 208.081 265.478 207.696 265.094C207.311 264.709 207.006 264.251 206.798 263.748C206.589 263.245 206.482 262.706 206.482 262.161C206.482 261.616 206.589 261.077 206.798 260.574C207.006 260.071 207.311 259.614 207.696 259.229C208.081 258.844 208.538 258.539 209.041 258.331C209.544 258.123 210.083 258.016 210.627 258.016H326.013C326.557 258.016 327.096 258.123 327.599 258.331C328.102 258.539 328.559 258.844 328.944 259.229C329.329 259.614 329.634 260.071 329.842 260.574C330.051 261.077 330.158 261.616 330.158 262.161C330.158 262.706 330.051 263.245 329.842 263.748C329.634 264.251 329.329 264.709 328.944 265.094C328.559 265.478 328.102 265.784 327.599 265.992C327.096 266.2 326.557 266.307 326.013 266.306Z"
          fill="#E6E6E6"
        />
        <path
          d="M188.605 209.967H153.814C153.288 209.966 152.783 209.756 152.411 209.384C152.039 209.011 151.83 208.506 151.829 207.979V176.975C151.83 176.449 152.039 175.943 152.411 175.571C152.783 175.198 153.288 174.989 153.814 174.988H188.605C189.131 174.989 189.636 175.198 190.008 175.571C190.38 175.943 190.589 176.449 190.59 176.975V207.979C190.589 208.506 190.38 209.011 190.008 209.384C189.636 209.756 189.131 209.966 188.605 209.967Z"
          fill="#E6E6E6"
        />
        <path
          d="M188.605 272.656H153.814C153.288 272.655 152.783 272.446 152.411 272.073C152.039 271.701 151.83 271.195 151.829 270.669V239.665C151.83 239.138 152.039 238.633 152.411 238.26C152.783 237.888 153.288 237.678 153.814 237.677H188.605C189.131 237.678 189.636 237.888 190.008 238.26C190.38 238.633 190.589 239.138 190.59 239.665V270.669C190.589 271.195 190.38 271.701 190.008 272.073C189.636 272.446 189.131 272.655 188.605 272.656Z"
          fill="#E6E6E6"
        />
        <path
          d="M309.044 119.842H236.565C235.467 119.842 234.414 119.405 233.638 118.628C232.861 117.851 232.425 116.796 232.425 115.697C232.425 114.598 232.861 113.544 233.638 112.766C234.414 111.989 235.467 111.552 236.565 111.552H309.044C310.142 111.552 311.195 111.989 311.972 112.766C312.748 113.544 313.184 114.598 313.184 115.697C313.184 116.796 312.748 117.851 311.972 118.628C311.195 119.405 310.142 119.842 309.044 119.842Z"
          fill="#CCCCCC"
        />
        <path
          d="M326.122 133.831H236.565C236.022 133.831 235.483 133.723 234.981 133.515C234.479 133.307 234.022 133.001 233.638 132.617C233.253 132.232 232.948 131.775 232.74 131.272C232.532 130.769 232.425 130.23 232.425 129.686C232.425 129.141 232.532 128.603 232.74 128.1C232.948 127.597 233.253 127.14 233.638 126.755C234.022 126.37 234.479 126.065 234.981 125.857C235.483 125.648 236.022 125.541 236.565 125.541H326.122C327.22 125.541 328.273 125.978 329.05 126.755C329.826 127.532 330.262 128.587 330.262 129.686C330.262 130.785 329.826 131.839 329.05 132.617C328.273 133.394 327.22 133.831 326.122 133.831Z"
          fill="#CCCCCC"
        />
        <path
          d="M220.525 150.783H153.705C153.179 150.782 152.674 150.573 152.302 150.2C151.93 149.828 151.721 149.323 151.72 148.796V96.5875C151.721 96.0606 151.93 95.5554 152.302 95.1828C152.674 94.8102 153.179 94.6007 153.705 94.6001H220.525C221.051 94.6007 221.556 94.8102 221.928 95.1828C222.3 95.5554 222.509 96.0606 222.51 96.5875V148.796C222.509 149.323 222.3 149.828 221.928 150.2C221.556 150.573 221.051 150.782 220.525 150.783Z"
          fill="#273069"
        />
        <path
          d="M334.09 326.682L335.471 317.628C335.744 315.842 337.438 314.621 339.256 314.901C341.074 315.181 342.327 316.856 342.054 318.642L339.687 334.163C339.414 335.949 340.667 337.624 342.485 337.904C344.303 338.184 345.997 336.963 346.27 335.177L348.637 319.656C348.91 317.87 350.604 316.649 352.422 316.929C354.24 317.209 355.493 318.882 355.22 320.668L354.332 326.49C353.809 329.922 358.897 331.111 360.49 328.657C360.934 327.973 362.083 324.339 362.083 324.339"
          stroke="white"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
        <path
          d="M382.612 295L379.289 298.323L385.935 304.969L389.258 301.646L382.612 295ZM375.966 301.646L362.674 314.938V321.584H369.32L382.612 308.292L375.966 301.646Z"
          fill="white"
        />
      </g>
      <defs>
        <clipPath id="clip0_0_1">
          <rect width="404" height="363" fill="white" />
        </clipPath>
      </defs>
    </svg>
  );

  const accordionContent = (accordion) => {
    return (
      <>
        <div className="flex flex-col gap-2 w-full">
          <div className="flex flex-row justify-between">
            <div
              className="flex flex-row gap-2"
              onMouseEnter={() => {
                setShowEdit(true);
              }}
              onMouseLeave={() => {
                setShowEdit(false);
              }}
            >
              <h1 className="font-bold text-md">Attached Files</h1>
              <button
                onClick={() => {
                  document.getElementById("changedriveID").showModal();
                  setgdrivefolder(selectedRecord.folder_id);
                }}
                className={`${showEdit ? "" : "hidden"}`}
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  className="size-4"
                >
                  <path d="M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z" />
                </svg>
              </button>
            </div>

            {accordion.gdrivefolder != null && accordion.gdrivefolder != "" && (
              <h1
                className="poppins-regular text-sm text-blue-500 cursor-pointer flex flex-row items-end"
                onClick={() => {
                  if (
                    accordion.gdrivefolder != null &&
                    accordion.gdrivefolder != ""
                  ) {
                    window.open(
                      `https://drive.google.com/drive/folders/${accordion.gdrivefolder}`,
                      "_blank"
                    );
                  } else {
                    showToast(
                      "warning",
                      "Please check again the Google Drive Folder ID."
                    );
                  }
                }}
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  className="size-6"
                >
                  <path
                    fillRule="evenodd"
                    d="M16.5 3.75a1.5 1.5 0 0 1 1.5 1.5v13.5a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5V15a.75.75 0 0 0-1.5 0v3.75a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3V5.25a3 3 0 0 0-3-3h-6a3 3 0 0 0-3 3V9A.75.75 0 1 0 9 9V5.25a1.5 1.5 0 0 1 1.5-1.5h6Zm-5.03 4.72a.75.75 0 0 0 0 1.06l1.72 1.72H2.25a.75.75 0 0 0 0 1.5h10.94l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 0 0-1.06 0Z"
                    clipRule="evenodd"
                  />
                </svg>
                Go to Drive
              </h1>
            )}
          </div>
          <div className="bg-white p-5 rounded-lg">
            {accordion.gdrivefolder != undefined &&
            accordion.gdrivefolder != "" ? (
              <FrameWrapper gdrivefolder={accordion.gdrivefolder} />
            ) : (
              <>
                <div className="flex flex-col items-center gap-2">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                    className="size-6"
                  >
                    <path
                      fillRule="evenodd"
                      d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"
                      clipRule="evenodd"
                    />
                  </svg>

                  <h1 className="font-bold text-lg">No folder ID specified.</h1>
                  <p className="text-sm">
                    Please provide the Google Drive folder ID for{" "}
                    {accordion.title}.
                  </p>

                  <div
                    className="py-2"
                    onClick={() => {
                      document.getElementById("changedriveID").showModal();
                      setgdrivefolder(selectedRecord.folder_id);
                    }}
                  >
                    <button className="btn btn-outline btn-sm">
                      Set Folder ID
                    </button>
                  </div>
                </div>
              </>
            )}
          </div>
        </div>
      </>
    );
  };

  const dialogComponents = () => {
    const warningSVG = (
      <svg
        width="91"
        height="91"
        viewBox="0 0 91 91"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M45.6423 23.8995V50.18M45.6423 67.7447L45.6861 67.6961M45.6422 89.6016C69.8546 89.6016 89.4829 69.9911 89.4829 45.8008C89.4829 21.6103 69.8546 2 45.6422 2C21.4297 2 1.80151 21.6103 1.80151 45.8008C1.80151 69.9911 21.4297 89.6016 45.6422 89.6016Z"
          stroke="#F38F33"
          strokeWidth="2.62921"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    );

    return (
      <>
        <dialog id="confirmationModal" className="modal">
          <div className="modal-box w-full md:w-1/2 lg:w-1/3  max-w-5xl">
            <div className="flex flex-col gap-5 items-center">
              {warningSVG}

              <h1 className="poppins-bold text-[20px]">Are you sure?</h1>

              <p className="poppins-regular text-[15px]">
                You want to proceed to the next step?
              </p>

              <div className="flex flex-row gap-10">
                <button
                  className="btn bg-primary text-white btn-sm py-5 flex flex-col justify-center items-center"
                  onClick={async (e) => {
                    let status = "error";
                    let message = "Failed to update the record.";
                    try {
                      const modified_by = `${currentUser.first_name} ${currentUser.last_name}`;

                      let response = await axios.patch(
                        `/record/record/${recordId}`,
                        { status: "Notarized", modified_by }
                      );

                      if (response.status === 200) {
                        status = "success";
                        message = "Record was updated successfully.";
                        dispatch(fetchRecord(recordId));
                      }
                    } catch (error) {
                      console.log(error);
                    } finally {
                      showToast(status, message);
                    }
                  }}
                >
                  Yes, proceed!
                </button>

                <button
                  className="btn bg-[#CDCDCD] btn-sm py-5 flex flex-col justify-center items-center px-5"
                  onClick={(e) => {
                    document.getElementById("confirmationModal").close();
                  }}
                >
                  Cancel
                </button>
              </div>
            </div>
          </div>
        </dialog>

        <dialog id="attachFileModal" className="modal">
          <div className="modal-box w-11/12 max-w-5xl">
            <div className="flex flex-row justify-between py-4">
              <form method="dialog">
                <button className="btn btn-sm btn-circle btn-ghost absolute right-3 top-2">
                  ✕
                </button>
              </form>
            </div>
            <div className="flex flex-col gap-5 items-center w-full">
              {accordionContent({
                title: "Attached Files",
                gdrivefolder: selectedRecord.folder_id,
              })}
            </div>
          </div>
        </dialog>

        <dialog id="changedriveID" className="modal">
          <div className="modal-box">
            <div className="flex flex-row justify-between py-4">
              <form method="dialog">
                <button className="btn btn-sm btn-circle btn-ghost absolute right-3 top-2">
                  ✕
                </button>
              </form>
            </div>
            <div className="flex flex-col gap-5">
              <h1 className="poppins-semibold text-md">
                Update Google Drive Folder ID
              </h1>
              <label className="form-control w-full">
                <div className="label">
                  <span className="poppins-regular text-[12px]">
                    Google Drive Folder ID{" "}
                    <span className="text-red-500">*</span>
                  </span>
                </div>
                <input
                  type="text"
                  className={`input input-bordered w-full ${
                    errors.gdrivefolder && `input-error`
                  }`}
                  name="gdrivefolders"
                  value={gdrivefolder}
                  onChange={(e) => {
                    setgdrivefolder(e.target.value);
                  }}
                />
                {errors.gdrivefolders && (
                  <span className="text-[12px] text-red-500">
                    {errors.gdrivefolder}
                  </span>
                )}
              </label>

              <button
                className="btn bg-primary text-white"
                onClick={async (e) => {
                  try {
                    let response = await axios.patch(
                      `/record/record/${recordId}`,
                      {
                        folder_id: gdrivefolder,
                      }
                    );
                    if (response.status === 200) {
                      dispatch(fetchRecord(recordId));
                    }
                  } catch (error) {
                    console.log(error);
                  } finally {
                    document.getElementById("changedriveID").close();
                  }
                }}
              >
                Save
              </button>
            </div>
          </div>
        </dialog>
      </>
    );
  };

  const dispatch = useDispatch();

  useEffect(() => {
    dispatch(fetchRecord(recordId));
  }, []);

  return (
    <>
      <div className="flex flex-col justify-between items-center flex-1">
        <div className="flex flex-col justify-center flex-1 w-full items-center">
          {routedForSignatureSVG}
        </div>
        <div className="w-full px-5 flex flex-row justify-end">
          {/* <button
            className="btn bg-primary text-white"
            onClick={() => {
              document.getElementById("attachFileModal").showModal();
            }}
          >
            Attach Files
          </button> */}
          <button
            className="btn btn-outline text-primary"
            onClick={() => {
              document.getElementById("confirmationModal").showModal();
            }}
          >
            For Notarization
          </button>
        </div>
      </div>

      <div>{dialogComponents()}</div>
    </>
  );
};

export default RoutedForSignatureComponent;
