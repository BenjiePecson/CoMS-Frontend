import { useEffect, useState } from "react";
import { useDispatch, useSelector } from "react-redux";
import {
  fetchRecord,
  gdrivefoldersState,
} from "../../../../store/GIS/GISRecordSlice";
import { useParams } from "react-router-dom";
import FrameWrapper from "../../DashboardComponents/FrameWrapper";
import Swal from "sweetalert2";
import axios from "axios";
import { showToast } from "../../../../../assets/global";

const SECFilingComponent = () => {
  const { companyId, recordId } = useParams();

  const selectedRecord = useSelector((state) => state.records.selectedRecord);

  const [errors, setErrors] = useState([]);

  const [gdrivefolder, setgdrivefolder] = useState("");
  const [showEdit, setShowEdit] = useState(false);

  const toggleUpdate = (setStatus, dialogText, btnText) => {
    Swal.fire({
      title: "Are you sure?",
      text: dialogText,
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#273069",
      confirmButtonText: btnText,
      cancelButtonColor: "#CDCDCD",
    }).then(async (result) => {
      if (result.isConfirmed) {
        let status = "error";
        let message = "Failed to update the record.";
        try {
          let response = await axios.patch(
            `/record/record/${selectedRecord.recordId}`,
            { status: setStatus }
          );

          if (response.status === 200) {
            status = "success";
            message = "Record was updated successfully.";
            // navigate(`/company/${companyId}/secretary-certificate`);
            dispatch(fetchRecord(recordId));
          }
        } catch (error) {
          console.log(error);
        } finally {
          showToast(status, message);
        }
      }
    });
  };

  const SECFilingSVG = (
    <svg
      className="w-1/2"
      viewBox="0 0 476 336"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g clipPath="url(#clip0_0_1)">
        <path
          d="M23.3167 270.117C23.5159 277.552 24.7615 284.922 27.0167 292.009C27.0667 292.174 27.1222 292.336 27.1762 292.5H40.9827C40.9682 292.353 40.9532 292.188 40.9387 292.009C40.0182 281.426 45.2772 217.783 51.6232 206.768C51.0672 207.661 22.2462 236.49 23.3167 270.117Z"
          fill="#F1F1F1"
        />
        <path
          d="M24.353 292.009C24.4685 292.174 24.5885 292.338 24.7115 292.5H35.0695C34.991 292.36 34.9 292.196 34.7945 292.009C33.0835 288.921 28.019 279.688 23.318 270.117C18.268 259.831 13.631 249.155 14.0215 245.291C13.9005 246.162 10.4045 272.729 24.353 292.009Z"
          fill="#F1F1F1"
        />
        <path
          d="M325.645 60.2885C326.041 61.2659 326.645 62.1447 327.417 62.8631C328.188 63.5815 329.108 64.122 330.111 64.4466C331.114 64.7711 332.176 64.8718 333.222 64.7414C334.268 64.6111 335.273 64.253 336.166 63.6924L356.156 79.7271L357.393 66.468L338.221 53.2738C337.18 51.8365 335.647 50.831 333.914 50.448C332.181 50.0649 330.368 50.3309 328.818 51.1956C327.267 52.0602 326.088 53.4634 325.504 55.1393C324.919 56.8152 324.97 58.6473 325.645 60.2885Z"
          fill="#9F616A"
        />
        <path
          d="M356.603 65.2229L349.142 59.9514L340.679 69.7289L350.523 75.5629L356.603 65.2229Z"
          fill="#273069"
        />
        <path
          d="M354.968 61.6478L380.112 71.3223L404.316 55.4734C406.818 53.8354 409.83 53.1637 412.79 53.5838C415.75 54.0039 418.457 55.487 420.404 57.7563C422.35 60.0255 423.405 62.9258 423.37 65.9156C423.335 68.9053 422.213 71.7802 420.214 74.0035L419.998 74.2439L382.771 94.203L342.107 75.6266L354.968 61.6478Z"
          fill="#3F3D56"
        />
        <path
          d="M347.88 291.5H85.8799L95.3799 106H136.38L174.187 132.5H357.38L347.88 291.5Z"
          fill="#E5E5E5"
        />
        <path
          d="M283.745 234.932L132.312 172.567C131.783 172.349 131.362 171.929 131.141 171.4C130.921 170.871 130.92 170.277 131.137 169.747L199.754 3.13126C199.973 2.60185 200.393 2.18082 200.921 1.96053C201.45 1.74025 202.045 1.73869 202.575 1.95622L354.007 64.3203C354.536 64.539 354.958 64.9588 355.178 65.4876C355.398 66.0164 355.4 66.6109 355.182 67.1408L286.565 233.756C286.346 234.286 285.927 234.707 285.398 234.927C284.869 235.148 284.275 235.149 283.745 234.932Z"
          fill="white"
        />
        <path
          d="M283.745 234.932L132.312 172.567C131.783 172.349 131.362 171.929 131.141 171.4C130.921 170.871 130.92 170.277 131.137 169.747L199.754 3.13126C199.973 2.60185 200.393 2.18082 200.921 1.96053C201.45 1.74025 202.045 1.73869 202.575 1.95622L354.007 64.3203C354.536 64.539 354.958 64.9588 355.178 65.4876C355.398 66.0164 355.4 66.6109 355.182 67.1408L286.565 233.756C286.346 234.286 285.927 234.707 285.398 234.927C284.869 235.148 284.275 235.149 283.745 234.932ZM202.246 2.75533C201.928 2.6248 201.571 2.62572 201.254 2.7579C200.936 2.89007 200.684 3.1427 200.553 3.46036L131.936 170.076C131.806 170.394 131.807 170.751 131.939 171.068C132.071 171.385 132.324 171.637 132.641 171.768L284.074 234.132C284.392 234.263 284.748 234.262 285.066 234.13C285.383 233.998 285.635 233.745 285.766 233.427L354.383 66.8117C354.514 66.4938 354.513 66.1371 354.38 65.8198C354.248 65.5025 353.996 65.2506 353.678 65.1194L202.246 2.75533Z"
          fill="#3F3D56"
        />
        <path
          d="M245.016 84.4332L207.457 68.9656C206.928 68.7468 206.507 68.327 206.286 67.7983C206.066 67.2695 206.065 66.6749 206.282 66.145L221.75 28.5866C221.969 28.0572 222.388 27.6361 222.917 27.4159C223.446 27.1956 224.04 27.194 224.57 27.4115L262.129 42.8791C262.658 43.0979 263.079 43.5177 263.299 44.0464C263.52 44.5752 263.521 45.1698 263.304 45.6997L247.836 83.2581C247.617 83.7875 247.198 84.2086 246.669 84.4289C246.14 84.6491 245.546 84.6507 245.016 84.4332ZM224.241 28.2106C223.923 28.0801 223.567 28.081 223.249 28.2132C222.932 28.3454 222.68 28.598 222.549 28.9157L207.081 66.4741C206.951 66.7921 206.952 67.1488 207.084 67.4661C207.216 67.7833 207.469 68.0352 207.786 68.1665L245.345 83.6341C245.663 83.7646 246.019 83.7637 246.337 83.6315C246.654 83.4993 246.906 83.2467 247.037 82.929L262.505 45.3706C262.635 45.0526 262.634 44.6959 262.502 44.3786C262.37 44.0614 262.117 43.8095 261.8 43.6783L224.241 28.2106Z"
          fill="#F2F2F2"
        />
        <path
          d="M232.335 84.5853L194.777 69.1177C194.3 68.9209 193.921 68.543 193.723 68.0671C193.525 67.5912 193.523 67.0561 193.719 66.5792L209.187 29.0208C209.384 28.5443 209.761 28.1653 210.237 27.9671C210.713 27.7688 211.248 27.7674 211.725 27.9632L249.284 43.4308C249.76 43.6277 250.139 44.0055 250.337 44.4814C250.536 44.9573 250.537 45.4924 250.341 45.9693L234.874 83.5278C234.677 84.0043 234.299 84.3832 233.823 84.5815C233.347 84.7797 232.812 84.7811 232.335 84.5853Z"
          fill="#273069"
        />
        <path
          d="M304.678 135.875L187.207 87.4974C186.971 87.4002 186.757 87.2573 186.576 87.0772C186.395 86.897 186.251 86.6829 186.153 86.4472C186.055 86.2115 186.004 85.9587 186.003 85.7033C186.003 85.448 186.053 85.195 186.15 84.9589C186.247 84.7228 186.39 84.5081 186.57 84.3272C186.75 84.1463 186.964 84.0026 187.2 83.9044C187.436 83.8062 187.689 83.7554 187.944 83.7549C188.199 83.7544 188.452 83.8041 188.688 83.9014L306.158 132.279C306.635 132.475 307.015 132.853 307.213 133.329C307.411 133.805 307.412 134.34 307.216 134.817C307.02 135.294 306.642 135.673 306.166 135.872C305.69 136.07 305.154 136.071 304.678 135.875Z"
          fill="#CCCCCC"
        />
        <path
          d="M271.208 136.578L182.106 99.8836C181.87 99.7864 181.656 99.6436 181.475 99.4634C181.294 99.2832 181.15 99.0691 181.052 98.8334C180.954 98.5977 180.903 98.3449 180.902 98.0896C180.902 97.8342 180.952 97.5813 181.049 97.3452C181.146 97.109 181.289 96.8944 181.469 96.7135C181.649 96.5325 181.863 96.3889 182.099 96.2907C182.335 96.1925 182.588 96.1416 182.843 96.1411C183.098 96.1406 183.351 96.1904 183.587 96.2876L272.689 132.982C273.166 133.178 273.545 133.556 273.743 134.032C273.942 134.508 273.943 135.044 273.746 135.521C273.55 135.997 273.172 136.377 272.696 136.575C272.22 136.773 271.685 136.774 271.208 136.578Z"
          fill="#CCCCCC"
        />
        <path
          d="M323.037 90.1607L271.094 68.7694C270.858 68.6721 270.643 68.5293 270.462 68.3491C270.282 68.1689 270.138 67.9549 270.04 67.7191C269.941 67.4834 269.891 67.2307 269.89 66.9753C269.89 66.72 269.939 66.467 270.037 66.2309C270.134 65.9948 270.277 65.7801 270.457 65.5992C270.637 65.4183 270.851 65.2746 271.087 65.1764C271.323 65.0782 271.575 65.0274 271.831 65.0269C272.086 65.0263 272.339 65.0761 272.575 65.1734L324.518 86.5647C324.994 86.7611 325.374 87.1389 325.572 87.6149C325.77 88.091 325.772 88.6263 325.575 89.1032C325.379 89.5801 325.001 89.9594 324.525 90.1577C324.049 90.356 323.514 90.3571 323.037 90.1607Z"
          fill="#CCCCCC"
        />
        <path
          d="M304.973 97.2084L265.993 81.1556C265.516 80.9592 265.137 80.5814 264.939 80.1054C264.74 79.6293 264.739 79.094 264.936 78.6171C265.132 78.1403 265.51 77.7609 265.986 77.5626C266.462 77.3643 266.997 77.3632 267.474 77.5596L306.453 93.6124C306.93 93.8088 307.31 94.1866 307.508 94.6626C307.706 95.1387 307.707 95.674 307.511 96.1509C307.315 96.6277 306.937 97.0071 306.461 97.2054C305.985 97.4037 305.449 97.4048 304.973 97.2084Z"
          fill="#CCCCCC"
        />
        <path
          d="M294.475 160.648L177.005 112.27C176.769 112.173 176.555 112.03 176.374 111.85C176.193 111.67 176.049 111.456 175.951 111.22C175.853 110.984 175.802 110.731 175.801 110.476C175.801 110.221 175.851 109.968 175.948 109.732C176.045 109.496 176.188 109.281 176.368 109.1C176.548 108.919 176.762 108.775 176.998 108.677C177.234 108.579 177.486 108.528 177.742 108.528C177.997 108.527 178.25 108.577 178.486 108.674L295.956 157.052C296.433 157.248 296.812 157.626 297.011 158.102C297.209 158.578 297.21 159.113 297.014 159.59C296.817 160.067 296.44 160.446 295.964 160.644C295.488 160.843 294.952 160.844 294.475 160.648Z"
          fill="#CCCCCC"
        />
        <path
          d="M261.006 161.351L171.904 124.656C171.668 124.559 171.453 124.416 171.273 124.236C171.092 124.056 170.948 123.842 170.85 123.606C170.752 123.37 170.701 123.118 170.7 122.862C170.7 122.607 170.749 122.354 170.847 122.118C170.944 121.882 171.087 121.667 171.267 121.486C171.447 121.305 171.661 121.162 171.897 121.063C172.133 120.965 172.385 120.914 172.641 120.914C172.896 120.913 173.149 120.963 173.385 121.06L262.487 157.755C262.723 157.852 262.937 157.995 263.118 158.175C263.299 158.355 263.443 158.569 263.541 158.805C263.639 159.041 263.69 159.293 263.691 159.549C263.691 159.804 263.641 160.057 263.544 160.293C263.447 160.529 263.304 160.744 263.124 160.925C262.944 161.106 262.73 161.25 262.494 161.348C262.258 161.446 262.005 161.497 261.75 161.497C261.495 161.498 261.242 161.448 261.006 161.351Z"
          fill="#CCCCCC"
        />
        <path
          d="M284.274 185.42L166.804 137.043C166.327 136.846 165.947 136.468 165.749 135.992C165.551 135.516 165.55 134.981 165.746 134.504C165.943 134.027 166.32 133.648 166.796 133.45C167.272 133.251 167.808 133.25 168.285 133.447L285.755 181.824C286.231 182.02 286.611 182.398 286.809 182.874C287.007 183.35 287.009 183.886 286.812 184.362C286.616 184.839 286.238 185.219 285.762 185.417C285.286 185.615 284.751 185.616 284.274 185.42Z"
          fill="#CCCCCC"
        />
        <path
          d="M279.173 197.806L161.703 149.429C161.226 149.233 160.846 148.855 160.648 148.379C160.45 147.903 160.449 147.367 160.645 146.891C160.841 146.414 161.219 146.034 161.695 145.836C162.171 145.638 162.707 145.637 163.184 145.833L280.654 194.21C280.89 194.308 281.104 194.45 281.285 194.631C281.466 194.811 281.61 195.025 281.708 195.261C281.806 195.496 281.857 195.749 281.858 196.004C281.858 196.26 281.808 196.513 281.711 196.749C281.614 196.985 281.471 197.2 281.291 197.381C281.111 197.562 280.897 197.705 280.661 197.803C280.425 197.902 280.172 197.952 279.917 197.953C279.662 197.953 279.409 197.904 279.173 197.806Z"
          fill="#CCCCCC"
        />
        <path
          d="M221.865 196.886C224.216 197.011 226.573 196.939 228.912 196.671C231.019 196.425 233.213 196.086 235.059 194.979C235.858 194.523 236.537 193.886 237.043 193.118C237.549 192.351 237.866 191.474 237.97 190.561C238.051 189.692 237.854 188.82 237.407 188.071C236.96 187.321 236.285 186.733 235.482 186.393C234.667 186.049 233.774 185.933 232.898 186.056C232.022 186.178 231.196 186.536 230.506 187.09C229.77 187.729 229.187 188.527 228.802 189.423C228.417 190.32 228.239 191.291 228.282 192.266C228.379 196.268 231.545 200.22 235.061 201.885C239.022 203.76 244.43 202.167 245.444 197.549C245.655 196.589 244.347 196.255 243.8 196.872C243.054 197.695 242.65 198.772 242.67 199.883C242.691 200.994 243.136 202.056 243.912 202.85C244.689 203.645 245.74 204.113 246.851 204.158C247.961 204.204 249.047 203.824 249.886 203.096L248.414 202.49C248.842 204.283 249.735 205.931 251.002 207.27C252.269 208.608 253.866 209.589 255.633 210.114C256.505 210.376 257.409 210.513 258.319 210.524C259.425 210.527 260.561 211.082 261.619 211.426L269.241 213.91C270.362 214.275 271.073 212.573 269.943 212.205L263.04 209.956C261.89 209.581 260.742 209.196 259.588 208.831C258.764 208.571 257.861 208.712 257 208.558C255.39 208.254 253.9 207.497 252.703 206.378C251.506 205.259 250.652 203.822 250.241 202.236C250.216 202.078 250.151 201.929 250.051 201.804C249.952 201.679 249.823 201.581 249.675 201.52C249.527 201.459 249.366 201.437 249.207 201.456C249.049 201.476 248.898 201.535 248.769 201.63C248.287 202.088 247.642 202.338 246.977 202.325C246.311 202.311 245.678 202.035 245.215 201.557C244.752 201.078 244.497 200.436 244.505 199.771C244.513 199.105 244.783 198.469 245.258 198.002L243.614 197.325C242.959 200.304 239.326 201.422 236.707 200.561C233.778 199.597 231.261 196.794 230.388 193.858C230.154 193.153 230.068 192.407 230.136 191.667C230.204 190.927 230.423 190.208 230.781 189.557C231.1 188.963 231.597 188.484 232.202 188.187C232.808 187.891 233.491 187.792 234.156 187.904C234.75 187.988 235.288 188.299 235.656 188.772C236.025 189.245 236.195 189.843 236.131 190.439C236.034 191.11 235.773 191.746 235.371 192.292C234.97 192.839 234.44 193.278 233.829 193.571C232.181 194.456 230.207 194.676 228.376 194.877C226.288 195.104 224.186 195.164 222.089 195.056C220.912 194.996 220.676 196.826 221.865 196.886Z"
          fill="#273069"
        />
        <path
          d="M347.88 145V291.5H85.8799V118.5H126.88L164.685 145H347.88Z"
          fill="white"
        />
        <path d="M208.88 264H101.88V272.5H208.88V264Z" fill="#273069" />
        <path d="M155.38 247.5H101.88V256H155.38V247.5Z" fill="#273069" />
        <path
          d="M348.38 292H85.3799V118H127.038L164.845 144.5H348.38V292ZM86.3799 291H347.38V145.5H164.529L126.722 119H86.3799V291Z"
          fill="#3F3D56"
        />
        <path
          d="M454.572 274.318L445.707 277.486L429.268 244.799L442.352 240.123L454.572 274.318Z"
          fill="#9F616A"
        />
        <path
          d="M431.319 292.319L431.19 291.958C430.139 289.007 430.302 285.759 431.642 282.928C432.983 280.097 435.391 277.913 438.34 276.855L455.799 270.615L459.905 282.104L431.319 292.319Z"
          fill="#2F2E41"
        />
        <path
          d="M396.924 283.086H387.51L383.031 246.773L396.926 246.773L396.924 283.086Z"
          fill="#9F616A"
        />
        <path
          d="M399.325 292.212L368.969 292.211V291.827C368.969 290.275 369.274 288.739 369.868 287.305C370.462 285.872 371.332 284.569 372.43 283.472C373.527 282.375 374.829 281.505 376.263 280.911C377.696 280.317 379.233 280.012 380.784 280.012H380.785L399.325 280.012L399.325 292.212Z"
          fill="#2F2E41"
        />
        <path
          d="M418.38 51.0932L414.285 43.0029C414.285 43.0029 399.033 46.8243 397.646 55.6644L418.38 51.0932Z"
          fill="#273069"
        />
        <path
          d="M435.273 143.599L424.139 205.733L453.703 258.018L436.041 264.929L406.093 214.247L402.253 200.424L399.949 272.608L384.021 272.124L376.717 204.722L388.431 142.063L435.273 143.599Z"
          fill="#2F2E41"
        />
        <path
          d="M432.969 115.527L432.584 79.0917C432.584 63.6498 422.421 52.2682 421.013 51.2154C420.35 49.0999 419.16 47.6376 417.479 46.8723C414.091 45.3369 409.948 47.1794 409.772 47.2623L397.343 51.9221L397.284 52.0927C397.152 52.4827 384.611 93.6368 381.462 103.965C381.014 105.447 380.755 106.295 380.755 106.295C380.755 106.295 380.804 108.684 380.892 112.398C381.17 125.169 381.828 153.616 382.091 154.81C382.091 154.81 405.049 158.29 414.14 158.29C430.493 158.29 440.88 155.161 441.114 155.107L441.49 155.029L432.969 115.527Z"
          fill="#3F3D56"
        />
        <path
          d="M409.628 38.3963C417.772 33.9448 420.765 23.7346 416.313 15.5912C411.862 7.44789 401.651 4.45508 393.508 8.9066C385.365 13.3581 382.372 23.5683 386.823 31.7116C391.275 39.855 401.485 42.8478 409.628 38.3963Z"
          fill="#9F616A"
        />
        <path
          opacity="0.2"
          d="M403.431 107.816L380.892 112.398C380.804 108.684 380.755 106.296 380.755 106.296C380.755 106.296 381.014 105.447 381.462 103.966L403.431 107.816Z"
          fill="black"
        />
        <path
          d="M336.685 103.013C337.485 103.7 338.426 104.202 339.442 104.485C340.457 104.768 341.523 104.825 342.562 104.652C343.602 104.479 344.592 104.08 345.461 103.484C346.33 102.887 347.058 102.107 347.593 101.198L372.717 106.245L367.719 93.9022L344.627 91.0018C343.041 90.2042 341.218 90.016 339.503 90.4727C337.787 90.9295 336.299 91.9996 335.321 93.4802C334.342 94.9608 333.94 96.749 334.191 98.506C334.443 100.263 335.33 101.867 336.685 103.013Z"
          fill="#9F616A"
        />
        <path
          d="M366.444 93.1604L357.394 91.9099L354.375 104.484L365.799 105.138L366.444 93.1604Z"
          fill="#273069"
        />
        <path
          d="M363.349 90.7372L390.125 87.7665L404.331 62.5626C405.799 59.9578 408.165 57.9764 410.987 56.9882C413.809 56 416.894 56.0726 419.666 57.1925C422.439 58.3124 424.709 60.403 426.052 63.0739C427.396 65.7449 427.722 68.8136 426.969 71.7072L426.887 72.0202L403.007 106.862L358.356 109.064L363.349 90.7372Z"
          fill="#3F3D56"
        />
        <path
          d="M415.882 38.2414L401.934 38.742C401.084 38.7725 398.777 29.5973 398.475 27.6939C398.236 26.4547 397.554 25.3448 396.557 24.5715C395.56 23.7981 394.315 23.4142 393.056 23.4915C392.011 23.5901 389.379 21.6395 386.662 19.3299C381.504 14.9449 381.773 6.70937 387.438 3.00409C387.593 2.90282 387.745 2.81035 387.894 2.72668C391.469 0.726122 395.65 0.0543101 399.746 0.00308013C403.458 -0.0433599 407.277 0.423961 410.548 2.18134C416.412 5.33195 419.533 12.2169 419.807 18.8682C420.081 25.5195 417.949 32.0233 415.529 38.2249"
          fill="#2F2E41"
        />
        <path
          d="M475.5 293H0.5C0.367392 293 0.240214 292.947 0.146446 292.854C0.052678 292.76 0 292.633 0 292.5C0 292.367 0.052678 292.24 0.146446 292.146C0.240214 292.053 0.367392 292 0.5 292H475.5C475.633 292 475.76 292.053 475.854 292.146C475.947 292.24 476 292.367 476 292.5C476 292.633 475.947 292.76 475.854 292.854C475.76 292.947 475.633 293 475.5 293Z"
          fill="#CBCBCB"
        />
      </g>
      <path
        d="M187 318.436V320.47H181.762V323.692H185.776V325.69H181.762V331H179.242V318.436H187ZM193.215 331.162C192.255 331.162 191.391 330.952 190.623 330.532C189.855 330.1 189.249 329.494 188.805 328.714C188.373 327.934 188.157 327.034 188.157 326.014C188.157 324.994 188.379 324.094 188.823 323.314C189.279 322.534 189.897 321.934 190.677 321.514C191.457 321.082 192.327 320.866 193.287 320.866C194.247 320.866 195.117 321.082 195.897 321.514C196.677 321.934 197.289 322.534 197.733 323.314C198.189 324.094 198.417 324.994 198.417 326.014C198.417 327.034 198.183 327.934 197.715 328.714C197.259 329.494 196.635 330.1 195.843 330.532C195.063 330.952 194.187 331.162 193.215 331.162ZM193.215 328.966C193.671 328.966 194.097 328.858 194.493 328.642C194.901 328.414 195.225 328.078 195.465 327.634C195.705 327.19 195.825 326.65 195.825 326.014C195.825 325.066 195.573 324.34 195.069 323.836C194.577 323.32 193.971 323.062 193.251 323.062C192.531 323.062 191.925 323.32 191.433 323.836C190.953 324.34 190.713 325.066 190.713 326.014C190.713 326.962 190.947 327.694 191.415 328.21C191.895 328.714 192.495 328.966 193.215 328.966ZM202.785 322.576C203.109 322.048 203.529 321.634 204.045 321.334C204.573 321.034 205.173 320.884 205.845 320.884V323.53H205.179C204.387 323.53 203.787 323.716 203.379 324.088C202.983 324.46 202.785 325.108 202.785 326.032V331H200.265V321.028H202.785V322.576ZM216.17 331.126C215.294 331.126 214.502 330.976 213.794 330.676C213.098 330.376 212.546 329.944 212.138 329.38C211.73 328.816 211.52 328.15 211.508 327.382H214.208C214.244 327.898 214.424 328.306 214.748 328.606C215.084 328.906 215.54 329.056 216.116 329.056C216.704 329.056 217.166 328.918 217.502 328.642C217.838 328.354 218.006 327.982 218.006 327.526C218.006 327.154 217.892 326.848 217.664 326.608C217.436 326.368 217.148 326.182 216.8 326.05C216.464 325.906 215.996 325.75 215.396 325.582C214.58 325.342 213.914 325.108 213.398 324.88C212.894 324.64 212.456 324.286 212.084 323.818C211.724 323.338 211.544 322.702 211.544 321.91C211.544 321.166 211.73 320.518 212.102 319.966C212.474 319.414 212.996 318.994 213.668 318.706C214.34 318.406 215.108 318.256 215.972 318.256C217.268 318.256 218.318 318.574 219.122 319.21C219.938 319.834 220.388 320.71 220.472 321.838H217.7C217.676 321.406 217.49 321.052 217.142 320.776C216.806 320.488 216.356 320.344 215.792 320.344C215.3 320.344 214.904 320.47 214.604 320.722C214.316 320.974 214.172 321.34 214.172 321.82C214.172 322.156 214.28 322.438 214.496 322.666C214.724 322.882 215 323.062 215.324 323.206C215.66 323.338 216.128 323.494 216.728 323.674C217.544 323.914 218.21 324.154 218.726 324.394C219.242 324.634 219.686 324.994 220.058 325.474C220.43 325.954 220.616 326.584 220.616 327.364C220.616 328.036 220.442 328.66 220.094 329.236C219.746 329.812 219.236 330.274 218.564 330.622C217.892 330.958 217.094 331.126 216.17 331.126ZM225.321 320.47V323.62H229.551V325.618H225.321V328.948H230.091V331H222.801V318.418H230.091V320.47H225.321ZM231.769 324.7C231.769 323.464 232.045 322.36 232.597 321.388C233.161 320.404 233.923 319.642 234.883 319.102C235.855 318.55 236.941 318.274 238.141 318.274C239.545 318.274 240.775 318.634 241.831 319.354C242.887 320.074 243.625 321.07 244.045 322.342H241.147C240.859 321.742 240.451 321.292 239.923 320.992C239.407 320.692 238.807 320.542 238.123 320.542C237.391 320.542 236.737 320.716 236.161 321.064C235.597 321.4 235.153 321.88 234.829 322.504C234.517 323.128 234.361 323.86 234.361 324.7C234.361 325.528 234.517 326.26 234.829 326.896C235.153 327.52 235.597 328.006 236.161 328.354C236.737 328.69 237.391 328.858 238.123 328.858C238.807 328.858 239.407 328.708 239.923 328.408C240.451 328.096 240.859 327.64 241.147 327.04H244.045C243.625 328.324 242.887 329.326 241.831 330.046C240.787 330.754 239.557 331.108 238.141 331.108C236.941 331.108 235.855 330.838 234.883 330.298C233.923 329.746 233.161 328.984 232.597 328.012C232.045 327.04 231.769 325.936 231.769 324.7ZM258.244 318.436V320.47H253.006V323.692H257.02V325.69H253.006V331H250.486V318.436H258.244ZM261.309 319.84C260.865 319.84 260.493 319.702 260.193 319.426C259.905 319.138 259.761 318.784 259.761 318.364C259.761 317.944 259.905 317.596 260.193 317.32C260.493 317.032 260.865 316.888 261.309 316.888C261.753 316.888 262.119 317.032 262.407 317.32C262.707 317.596 262.857 317.944 262.857 318.364C262.857 318.784 262.707 319.138 262.407 319.426C262.119 319.702 261.753 319.84 261.309 319.84ZM262.551 321.028V331H260.031V321.028H262.551ZM267.561 317.68V331H265.041V317.68H267.561ZM271.329 319.84C270.885 319.84 270.513 319.702 270.213 319.426C269.925 319.138 269.781 318.784 269.781 318.364C269.781 317.944 269.925 317.596 270.213 317.32C270.513 317.032 270.885 316.888 271.329 316.888C271.773 316.888 272.139 317.032 272.427 317.32C272.727 317.596 272.877 317.944 272.877 318.364C272.877 318.784 272.727 319.138 272.427 319.426C272.139 319.702 271.773 319.84 271.329 319.84ZM272.571 321.028V331H270.051V321.028H272.571ZM280.586 320.884C281.774 320.884 282.734 321.262 283.466 322.018C284.198 322.762 284.564 323.806 284.564 325.15V331H282.044V325.492C282.044 324.7 281.846 324.094 281.45 323.674C281.054 323.242 280.514 323.026 279.83 323.026C279.134 323.026 278.582 323.242 278.174 323.674C277.778 324.094 277.58 324.7 277.58 325.492V331H275.06V321.028H277.58V322.27C277.916 321.838 278.342 321.502 278.858 321.262C279.386 321.01 279.962 320.884 280.586 320.884ZM290.867 320.866C291.611 320.866 292.265 321.016 292.829 321.316C293.393 321.604 293.837 321.982 294.161 322.45V321.028H296.699V331.072C296.699 331.996 296.513 332.818 296.141 333.538C295.769 334.27 295.211 334.846 294.467 335.266C293.723 335.698 292.823 335.914 291.767 335.914C290.351 335.914 289.187 335.584 288.275 334.924C287.375 334.264 286.865 333.364 286.745 332.224H289.247C289.379 332.68 289.661 333.04 290.093 333.304C290.537 333.58 291.071 333.718 291.695 333.718C292.427 333.718 293.021 333.496 293.477 333.052C293.933 332.62 294.161 331.96 294.161 331.072V329.524C293.837 329.992 293.387 330.382 292.811 330.694C292.247 331.006 291.599 331.162 290.867 331.162C290.027 331.162 289.259 330.946 288.563 330.514C287.867 330.082 287.315 329.476 286.907 328.696C286.511 327.904 286.313 326.998 286.313 325.978C286.313 324.97 286.511 324.076 286.907 323.296C287.315 322.516 287.861 321.916 288.545 321.496C289.241 321.076 290.015 320.866 290.867 320.866ZM294.161 326.014C294.161 325.402 294.041 324.88 293.801 324.448C293.561 324.004 293.237 323.668 292.829 323.44C292.421 323.2 291.983 323.08 291.515 323.08C291.047 323.08 290.615 323.194 290.219 323.422C289.823 323.65 289.499 323.986 289.247 324.43C289.007 324.862 288.887 325.378 288.887 325.978C288.887 326.578 289.007 327.106 289.247 327.562C289.499 328.006 289.823 328.348 290.219 328.588C290.627 328.828 291.059 328.948 291.515 328.948C291.983 328.948 292.421 328.834 292.829 328.606C293.237 328.366 293.561 328.03 293.801 327.598C294.041 327.154 294.161 326.626 294.161 326.014Z"
        fill="black"
      />
      <defs>
        <clipPath id="clip0_0_1">
          <rect width="476" height="293" fill="white" />
        </clipPath>
      </defs>
    </svg>
  );

  const accordionContent = (accordion) => {
    return (
      <>
        <div className="flex flex-col gap-2 w-full">
          <div className="flex flex-row justify-between">
            <div
              className="flex flex-row gap-2"
              onMouseEnter={() => {
                setShowEdit(true);
              }}
              onMouseLeave={() => {
                setShowEdit(false);
              }}
            >
              <h1 className="font-bold text-md">Attached Files</h1>
              <button
                onClick={() => {
                  document.getElementById("changedriveID").showModal();
                  setgdrivefolder(selectedRecord.folder_id);
                }}
                className={`${showEdit ? "" : "hidden"}`}
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  className="size-4"
                >
                  <path d="M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z" />
                </svg>
              </button>
            </div>

            {accordion.gdrivefolder != null && accordion.gdrivefolder != "" && (
              <h1
                className="poppins-regular text-sm text-blue-500 cursor-pointer flex flex-row items-end"
                onClick={() => {
                  if (
                    accordion.gdrivefolder != null &&
                    accordion.gdrivefolder != ""
                  ) {
                    window.open(
                      `https://drive.google.com/drive/folders/${accordion.gdrivefolder}`,
                      "_blank"
                    );
                  } else {
                    showToast(
                      "warning",
                      "Please check again the Google Drive Folder ID."
                    );
                  }
                }}
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  className="size-6"
                >
                  <path
                    fillRule="evenodd"
                    d="M16.5 3.75a1.5 1.5 0 0 1 1.5 1.5v13.5a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5V15a.75.75 0 0 0-1.5 0v3.75a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3V5.25a3 3 0 0 0-3-3h-6a3 3 0 0 0-3 3V9A.75.75 0 1 0 9 9V5.25a1.5 1.5 0 0 1 1.5-1.5h6Zm-5.03 4.72a.75.75 0 0 0 0 1.06l1.72 1.72H2.25a.75.75 0 0 0 0 1.5h10.94l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 0 0-1.06 0Z"
                    clipRule="evenodd"
                  />
                </svg>
                Go to Drive
              </h1>
            )}
          </div>
          <div className="bg-white p-5 rounded-lg">
            {accordion.gdrivefolder != undefined &&
            accordion.gdrivefolder != "" ? (
              <FrameWrapper gdrivefolder={accordion.gdrivefolder} />
            ) : (
              <>
                <div className="flex flex-col items-center gap-2">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                    className="size-6"
                  >
                    <path
                      fillRule="evenodd"
                      d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"
                      clipRule="evenodd"
                    />
                  </svg>

                  <h1 className="font-bold text-lg">No folder ID specified.</h1>
                  <p className="text-sm">
                    Please provide the Google Drive folder ID for{" "}
                    {accordion.title}.
                  </p>

                  <div
                    className="py-2"
                    onClick={() => {
                      document.getElementById("changedriveID").showModal();
                      setgdrivefolder(selectedRecord.folder_id);
                    }}
                  >
                    <button className="btn btn-outline btn-sm">
                      Set Folder ID
                    </button>
                  </div>
                </div>
              </>
            )}
          </div>
        </div>
      </>
    );
  };

  const dialogComponents = () => {
    const warningSVG = (
      <svg
        width="91"
        height="91"
        viewBox="0 0 91 91"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M45.6423 23.8995V50.18M45.6423 67.7447L45.6861 67.6961M45.6422 89.6016C69.8546 89.6016 89.4829 69.9911 89.4829 45.8008C89.4829 21.6103 69.8546 2 45.6422 2C21.4297 2 1.80151 21.6103 1.80151 45.8008C1.80151 69.9911 21.4297 89.6016 45.6422 89.6016Z"
          stroke="#F38F33"
          strokeWidth="2.62921"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </svg>
    );

    return (
      <>
        <dialog id="confirmationModal" className="modal">
          <div className="modal-box w-full md:w-1/2 lg:w-1/3  max-w-5xl">
            <div className="flex flex-col gap-5 items-center">
              {warningSVG}

              <h1 className="poppins-bold text-[20px]">Are you sure?</h1>

              <p className="poppins-regular text-[15px]">
                You want to proceed to the next step?
              </p>

              <div className="flex flex-row gap-10">
                <button
                  className="btn bg-primary text-white btn-sm py-5 flex flex-col justify-center items-center"
                  onClick={async (e) => {
                    let status = "error";
                    let message = "Failed to update the record.";
                    try {
                      let response = await axios.patch(
                        `/record/record/${selectedRecord.recordId}`,
                        { status: "Filed with SEC" }
                      );

                      if (response.status === 200) {
                        status = "success";
                        message = "Record was updated successfully.";
                        dispatch(fetchRecord(recordId));
                      }
                    } catch (error) {
                      console.log(error);
                    } finally {
                      showToast(status, message);
                    }
                  }}
                >
                  Yes, proceed!
                </button>

                <button
                  className="btn bg-[#CDCDCD] btn-sm py-5 flex flex-col justify-center items-center px-5"
                  onClick={(e) => {
                    document.getElementById("confirmationModal").close();
                  }}
                >
                  Cancel
                </button>
              </div>
            </div>
          </div>
        </dialog>

        <dialog id="attachFileModal" className="modal">
          <div className="modal-box w-11/12 max-w-5xl">
            <div className="flex flex-row justify-between py-4">
              <form method="dialog">
                <button className="btn btn-sm btn-circle btn-ghost absolute right-3 top-2">
                  ✕
                </button>
              </form>
            </div>
            <div className="flex flex-col gap-5 items-center w-full">
              {accordionContent({
                title: "Attached Files",
                gdrivefolder: selectedRecord.folder_id,
              })}
            </div>
          </div>
        </dialog>

        <dialog id="changedriveID" className="modal">
          <div className="modal-box">
            <div className="flex flex-row justify-between py-4">
              <form method="dialog">
                <button className="btn btn-sm btn-circle btn-ghost absolute right-3 top-2">
                  ✕
                </button>
              </form>
            </div>
            <div className="flex flex-col gap-5">
              <h1 className="poppins-semibold text-md">
                Update Google Drive Folder ID
              </h1>
              <label className="form-control w-full">
                <div className="label">
                  <span className="poppins-regular text-[12px]">
                    Google Drive Folder ID{" "}
                    <span className="text-red-500">*</span>
                  </span>
                </div>
                <input
                  type="text"
                  className={`input input-bordered w-full ${
                    errors.gdrivefolder && `input-error`
                  }`}
                  name="gdrivefolders"
                  value={gdrivefolder}
                  onChange={(e) => {
                    setgdrivefolder(e.target.value);
                  }}
                />
                {errors.gdrivefolders && (
                  <span className="text-[12px] text-red-500">
                    {errors.gdrivefolder}
                  </span>
                )}
              </label>

              <button
                className="btn bg-primary text-white"
                onClick={async (e) => {
                  try {
                    let response = await axios.patch(
                      `/record/record/${recordId}`,
                      {
                        folder_id: gdrivefolder,
                      }
                    );
                    if (response.status === 200) {
                      dispatch(fetchRecord(recordId));
                    }
                  } catch (error) {
                    console.log(error);
                  } finally {
                    document.getElementById("changedriveID").close();
                  }
                }}
              >
                Save
              </button>
            </div>
          </div>
        </dialog>
      </>
    );
  };

  const dispatch = useDispatch();

  useEffect(() => {
    dispatch(fetchRecord(recordId));
  }, []);

  return (
    <>
      <div className="flex flex-col justify-between items-center flex-1">
        <div className="flex flex-col justify-center flex-1 w-full items-center">
          {SECFilingSVG}
        </div>
        <div className="w-full px-5 flex flex-row justify-between">
          <button
            className="btn bg-primary text-white"
            onClick={() => {
              document.getElementById("attachFileModal").showModal();
            }}
          >
            Attach Files
          </button>
          <button
            className="btn"
            onClick={() => {
              document.getElementById("confirmationModal").showModal();
            }}
          >
            Filed with SEC
          </button>
        </div>
      </div>

      <div>{dialogComponents()}</div>
    </>
  );
};

export default SECFilingComponent;
